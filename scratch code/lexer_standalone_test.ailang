// Copyright (c) 2025 Sean Collins, 2 Paws Machine and Engineering. All rights reserved.
//
// Licensed under the Sean Collins Software License (SCSL). See the LICENSE file in the root directory of this project
// for the full terms and conditions, including restrictions on forking, corporate use, and permissions for private/teaching purposes.


// Copyright (c) 2025 Sean Collins, 2 Paws Machine and Engineering. All rights reserved.
//
// Licensed under the Sean Collins Software License (SCSL). See the LICENSE file in the root directory of this project
// for the full terms and conditions, including restrictions on forking, corporate use, and permissions for private/teaching purposes.


// lexer_standalone_test.ailang
// Direct lexer test - bypasses console, tests lexer directly
// Compile: python3 main.py lexer_standalone_test.ailang
// Run: ./lexer_standalone_test_exec

LibraryImport.XArrays
LibraryImport.Compiler.Frontend.Lexer.CLexerTypes
LibraryImport.Compiler.Frontend.Lexer.CLexerCore
LibraryImport.Compiler.Frontend.Lexer.CLexerKeywords
LibraryImport.Compiler.Frontend.Lexer.CLexerStrings
LibraryImport.Compiler.Frontend.Lexer.CLexerNumbers
LibraryImport.Compiler.Frontend.Lexer.CLexerOperators
LibraryImport.Compiler.Frontend.Lexer.CLexerIdentifiers
LibraryImport.Compiler.Frontend.Lexer.CLexerMain

// =============================================================================
// TEST CASES
// =============================================================================

Function.TestCase1_SimpleAssignment {
    Body: {
        PrintMessage("=== Test 1: Simple Assignment ===\n")
        
        src = "x = 42"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase2_Numbers {
    Body: {
        PrintMessage("=== Test 2: Number Formats ===\n")
        
        src = "dec = 12345"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase3_HexNumber {
    Body: {
        PrintMessage("=== Test 3: Hex Number ===\n")
        
        src = "hex = 0xFF"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase4_TwoCharOps {
    Body: {
        PrintMessage("=== Test 4: Two-Char Operators (==) ===\n")
        
        src = "a == b"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        PrintMessage("Expected: IDENTIFIER, EQUALTO(EqualTo), IDENTIFIER, EOF\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase5_Keywords {
    Body: {
        PrintMessage("=== Test 5: Keywords ===\n")
        
        src = "IfCondition Add"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        PrintMessage("Expected: IFCONDITION, ADD, EOF (NOT IDENTIFIER)\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase6_DottedIdentifier {
    Body: {
        PrintMessage("=== Test 6: Dotted Identifier ===\n")
        
        src = "Pool.field"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        PrintMessage("Expected: IDENTIFIER(Pool.field), EOF\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase7_Delimiters {
    Body: {
        PrintMessage("=== Test 7: Delimiters ===\n")
        
        src = "{ } ( )"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase8_FunctionCall {
    Body: {
        PrintMessage("=== Test 8: Function Call ===\n")
        
        src = "Add(10, 20)"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase9_Assignment {
    Body: {
        PrintMessage("=== Test 9: Assignment Statement ===\n")
        
        src = "result = Add(1, 2)"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

Function.TestCase10_Arrow {
    Body: {
        PrintMessage("=== Test 10: Arrow Operator ===\n")
        
        src = "Output: Integer"
        len = StringLength(src)
        
        Lex_Init(src, len)
        Lex_Tokenize()
        
        PrintMessage("Source: ")
        PrintMessage(src)
        PrintMessage("\n")
        
        Lex_DumpTokens()
        Lex_Free()
        
        PrintMessage("\n")
        ReturnValue(0)
    }
}

// =============================================================================
// MAIN ENTRY POINT
// =============================================================================

SubRoutine.Main {
    PrintMessage("==================================================\n")
    PrintMessage("   AILang Self-Hosting Lexer Test Suite\n")
    PrintMessage("   Direct lexer testing without console\n")
    PrintMessage("==================================================\n\n")
    
    TestCase1_SimpleAssignment()
    TestCase2_Numbers()
    TestCase3_HexNumber()
    TestCase4_TwoCharOps()
    TestCase5_Keywords()
    TestCase6_DottedIdentifier()
    TestCase7_Delimiters()
    TestCase8_FunctionCall()
    TestCase9_Assignment()
    TestCase10_Arrow()
    
    PrintMessage("==================================================\n")
    PrintMessage("   ALL TESTS COMPLETE\n")
    PrintMessage("==================================================\n")
}

RunTask(Main)