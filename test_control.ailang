// test_control.ailang
// Tests control flow with comparison operations
// Critical for self-hosting compiler capability

SubRoutine.Main {
    PrintMessage("=== Control Flow Tests ===\n")
    
    // Simple IfCondition test
    PrintMessage("\n--- IfCondition Tests ---\n")
    
    x = 10
    IfCondition EqualTo(x, 10) ThenBlock: {
        PrintMessage("PASS: x equals 10\n")
    } ElseBlock: {
        PrintMessage("FAIL: x should equal 10\n")
    }
    
    IfCondition LessThan(5, 10) ThenBlock: {
        PrintMessage("PASS: 5 < 10\n")
    } ElseBlock: {
        PrintMessage("FAIL: 5 should be < 10\n")
    }
    
    IfCondition GreaterThan(10, 5) ThenBlock: {
        PrintMessage("PASS: 10 > 5\n")
    } ElseBlock: {
        PrintMessage("FAIL: 10 should be > 5\n")
    }
    
    // Nested IfCondition
    a = 5
    b = 10
    IfCondition LessThan(a, b) ThenBlock: {
        IfCondition EqualTo(a, 5) ThenBlock: {
            PrintMessage("PASS: Nested conditions work\n")
        }
    }
    
    // WhileLoop tests
    PrintMessage("\n--- WhileLoop Tests ---\n")
    
    PrintMessage("Counting 1 to 5: ")
    i = 1
    WhileLoop LessEqual(i, 5) {
        PrintNumber(i)
        PrintMessage(" ")
        i = Add(i, 1)
    }
    PrintMessage("\n")
    
    // Countdown
    PrintMessage("Countdown from 5: ")
    j = 5
    WhileLoop GreaterThan(j, 0) {
        PrintNumber(j)
        PrintMessage(" ")
        j = Subtract(j, 1)
    }
    PrintMessage("\n")
    
    // Sum computation
    PrintMessage("\nSum 1 to 10: ")
    sum = 0
    k = 1
    WhileLoop LessEqual(k, 10) {
        sum = Add(sum, k)
        k = Add(k, 1)
    }
    PrintNumber(sum)
    PrintMessage(" (expect 55)\n")
    
    // Factorial of 5
    PrintMessage("Factorial of 5: ")
    n = 5
    fact = 1
    WhileLoop GreaterThan(n, 0) {
        fact = Multiply(fact, n)
        n = Subtract(n, 1)
    }
    PrintNumber(fact)
    PrintMessage(" (expect 120)\n")
    
    // ExitLoop test
    PrintMessage("\nExitLoop test (break at 3): ")
    m = 1
    WhileLoop LessThan(m, 100) {
        PrintNumber(m)
        PrintMessage(" ")
        IfCondition EqualTo(m, 3) ThenBlock: {
            ExitLoop
        }
        m = Add(m, 1)
    }
    PrintMessage("\n")
    
    PrintMessage("\n=== All Control Flow Tests Complete ===\n")
}
RunTask(Main)